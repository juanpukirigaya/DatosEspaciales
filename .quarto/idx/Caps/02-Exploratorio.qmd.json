{"title":"Análisis Exploratorio","markdown":{"headingText":"Análisis Exploratorio","containsRefs":false,"markdown":"En esta primera sección se revisan herramientas básicas para un análisis descriptivo de datos espaciales.\n\nComo en otros modelos estadísticos, un punto de partida es revisar sobre qué tipo de objeto probabilista se busca hacer inferencia. Es muy útil recordar primero la noción de *proceso estocástico* tal como se da en [@Klenke].\n\n::: {#def-proceso-estocastico}\n\n### Proceso estocástico\n\nSea $I\\subseteq\\mathbb{R}$. Una familia de variables aleatorias $Z={(Z_t)}_{t\\in I}$, en un espacio de probabilidad $(\\Omega,\\mathcal{F},\\mathbb{P})$, que toma valores en $(E,\\mathcal{E})$, es un *proceso estocástico* con conjunto de tiempo $I$ y espacio de estados $E$.\n\n:::\n\nMuchas de las técnicas para estudiar estos procesos que varían en el tiempo dependen de que $I$ es un conjunto ordenado. Además, para cada $\\omega\\in\\Omega$, el mapeo $t\\mapsto Z_t(\\omega)$ indica *lo que hace el proceso a tiempo $t$*. A partir de esto, es inmediato extender la definición a un proceso espacial (o espacio-temporal).\n\n::: {#def-proceso-espacio-temporal}\n\n### Proceso espacio-temporal\n\nSean $I\\subseteq\\mathbb{R}$ y $A\\subseteq\\mathbb{R}^d$. Una familia de variables aleatorias $Z={(Z_{x,t})}_{(x,t)\\in A\\times I}$, en un espacio de probabilidad $(\\Omega,\\mathcal{F},\\mathbb{P})$, que toma valores en $(E,\\mathcal{E})$, es un *proceso espacio-temporal* en la región $A$ con conjunto de tiempo $I$ y espacio de estados $E$.\n\n:::\n\nEn este texto se manejarán únicamente procesos espaciales, es decir, consideraremos que $t$ es fijo. A una realización del proceso le denotaremos por $z={(z(x))}_{x\\in A}$. En el contexto del análisis estadístico, se consideran distintos tipos de datos (o realizaciones ed $Z$).\n\n::: {#def-dato-espacial}\n\n### Dato espacial\n\nUn *dato espacial* es aquel que incluye, además de su valor (numérico, categórico, conteo, etc.), información de localización. Esta información puede ser en forma de coordenadas, ubicaciones discretas en una red o cualquier otra manera de localización.\n\n:::\n\n## Tipos de datos espaciales\n\nA partir de la estructura de esta realización $z$, se pueden considerar distintos tipos de datos espaciales. De manera no exhaustiva, a continuación se presentan algunos de estos tipos de datos.\n\n### Datos de área o en retícula \nSi $A$ es una unión numerable de unidades de área, decimos que la muestra $z$ son *datos de área o de retícula*. Este tipo de estructuras es común en imágenes satelitales, en el análisis de suelos y algunos estudios experimentales en agricultura. También se encuentran las imágenes médicas y la teledetección. Los datos pueden representar toda la población (imagen completa) o una submuestra.\n\nEl énfasis en hablar de \"unidades de área\" tiene más sentido al considerar que un mapa con división territorial cumple con estas propiedades. Siguiendo a [@Moraga], a continuación se presentan un mapa del número de muertes repentinas de niños en cada condado de Carolina del Norte, EE.UU., en el año de 1974, reportado originalmente en [@Pebesma].\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(sf)\nlibrary(mapview)\nd <- st_read(system.file(\"shape/nc.shp\", package = \"sf\"), quiet = TRUE)\nmapview(d, zcol = \"SID74\")\n```\n\nEn el anterior ejemplo, cada región del espacio es un condado. A continuación se presenta un mapa sobre la elevación de Luxemburgo, en el cual todas las regiones del mismo tamaño y están distribuidas de manera uniforme en el espacio, también tomado de [@Moraga].\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(terra)\nd <- rast(system.file(\"ex/elev.tif\", package = \"terra\"))\nplot(d)\n```\n\n\n### Datos geoestadísticos {#sec-datgeost}\nEstos datos se miden de manera continua en el espacio, por lo que se consideran formas posiblemente irregulares. Una complicación de este tipo de datos es que normalmente sólo se dispone de observaciones en algunos puntos del espacio. Estos datos aparecen típicamente en cuestiones mineras, de ciencias del suelo, hidrológicas, meteorológicas u otros temas geológicos.\n\nComo ejemplo, se muestra la distribución de plomo superficial en mg por kg de tierra, en un terreno muestreado tras una inundación del río Meuse en Países Bajos. Estos datos son de la librería **sp** de R.\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(sp)\nlibrary(sf)\nlibrary(mapview)\n\ndata(meuse)\nmeuse <- st_as_sf(meuse, coords = c(\"x\", \"y\"), crs = 28992)\nmapview(meuse, zcol = \"lead\",  map.types = \"CartoDB.Voyager\")\n```\n\nEste tipo de datos se obtienen con mediciones de infiltrómetros revisando la capacidad del suelo para absorber agua.\n\nEn este tipo de datos, las ubicaciones de muestreo son generalmente irregulares y se tiene como objetivo predecir la variable en ubicaciones no observadas. Esto se hace bajo la hipótesis de continuidad espacial del campo y que la correlación entre observaciones depende de la distancia.\n\n### Patrones puntuales\nEn este tipo de datos se centra el estudio en capítulos posteriores y en el caso de estudio. Aquí el dominio $A$ se toma como aleatorio y las variables en $Z$ sólo valen 1 o 0, indicando la ocurrencia o no de un evento. Estos patrones surgen de *ubicar* eventos, tales como aparición de enfermedades, nacimiento de especies, ubicación de viviendas, entre otros.\n\nComo ejemplo, se presentan los datos de *pinos de hoja larga en Georgia*, los cuales se pueden encontrar en la biblioteca **spatstat** de R. Lo que se mide es la presencia de pinos con longitud de hoja mayor a cierto parámetro. El objetivo del estudio era ver si los árboles con estas características están distribuidos uniformemente al azar en la región o si se tiene algún tipo de agrupamiento o regularidad.\n```{r, message=FALSE, warning=FALSE}\nlibrary(spatstat)\n\ndata(longleaf)\n\nplot(longleaf, use.marks = FALSE, pch = 20, cex = 0.5, main = \"Pinos de hoja larga en Georgia\")\n```\n\nSe pueden considerar versiones más generales de este tipo de datos, como los datos puntuales marcados. En los datos puntuales marcados se considera que las observaciones pueden ser de distintos tipos dada alguna característica cualitativa.\n\nLa característica principal de este tipo de datos es que el interés está centrado en la posición de los eventos, ya que no hay variables medidas continuamente en el espacio. \n\n## Herramientas descriptivas\n\n### El variograma\nUna herramienta de gran utilidad en el análisis de este tipo de procesos con estructura adicional es el *variograma*. La idea de este estadístico es estudiar empíricamente la estructura de covarianza del proceso espacial.\n\nLa idea se toma del contexto de series de tiempo, donde se busca medir la influencia de tiempos anteriores en el instante de estudio. Algunas de las definiciones de interés en el contexto de las series de tiempo se presentan a continuación, como se enuncian en [@Rincon].\n\n::: {#def-covTS}\n\n### Estructura de covarianza y estacionareidad\n\nSea $X={(X_t)}_{t\\in\\mathbb{Z}}$ una serie de tiempo.\n\n1. Si $X$ tiene media finita, la *función media* es $t\\mapsto\\mu(t)=\\mathbb{E}[X_t]$ para cada $t\\in\\mathbb{Z}$.\n2. Si $X$ tiene segundo momento finito, la *función varianza* es $t\\mapsto\\text{Var}(X_t)$ para cada $t\\in\\mathbb{Z}$.\n3. Si $X$ tiene segundo momento, la *función de autocovarianza* es $(s,t)\\mapsto\\gamma(s,t)=\\text{Cov}[X_s,X_t]$.\n4. $X$ es *estrictamente estacionaria* si para cualesquiera $k\\geq 1$ y $\\tau\\in\\mathbb{Z}$ se cumple que $(X_1,\\ldots,X_k)\\overset{d}{=}(X_{1+\\tau},\\ldots,X_{k+\\tau})$.\n5. $X$ es *débilmente estacionaria* si satisface que $\\mu(t)=\\mu$ y $\\gamma(t,t+\\tau)=\\gamma(\\tau)$.\n6. Si $X$ es estacionaria, la *función de autocorrelación* es $\\displaystyle\\rho(\\tau)=\\frac{\\gamma(\\tau)}{\\gamma(0)}$.\n\n:::\n\nLa propiedad de *ser estacionaria* quiere decir que la estructura de correlación depende únicamente del tamaño del periodo que se revise y no de los instantes específicos en los que se vea el proceso, tal tamaño del periodo es la separación entre el inicio y el final del periodo. En el contexto de los datos espaciales, las nociones de estacionaridad se definen en términos de la distancia entre dos puntos.\n\n::: {#def-covSP}\n\n### Proceso espacial estacionario\n\nSea $Z={(Z(s))}_{s\\in A\\subseteq\\mathbb{R}^d}$ un proceso espacial. Decimos que $Z$ es un *proceso intrínsecamente estacionario* si satisface que para todos $s,h\\in\\mathbb{R}^d$\n\n$$\\mathbb{E}[Z(s+h)-Z(s)]=0\\quad\\text{y}\\quad\\text{Var}(Z(s+h)-Z(t))=2\\gamma(h),$$\n\ndonde $\\gamma$ es el *variograma* de $Z$. $\\gamma$ satisface que, para todos $s_1,\\ldots,s_k\\in A$ y $\\alpha_1,\\ldots,\\alpha_n\\in\\mathbb{C}$ tales que $\\alpha_1+\\cdots+\\alpha_n=0$\n\n$$\\sum_{i=1}^k\\sum_{k=1}^k\\alpha_i\\overline{\\alpha}_j2\\gamma(s_i-s_j)\\leq 0.$$\n\n:::\n\nEn pocas palabras, el variograma es una medida de la tendencia a ser diferentes de los valores según su distancia. Algunos comentarios que se pueden hacer a partir del variograma son las siguientes.\n\n- Cuando $h$ es pequeño, se espera que $\\gamma(h)$ sea pequeño, es decir, que las observaciones sean similares.\n- Cuando $h$ crece, usualmente $\\gamma(h)$ suele aumentar.\n- A partir de cierto $h_0$, usualmente para $h\\geq h_0$ se tiene que $\\gamma(h)\\approx\\text{cte.}$. A este $h_0$ se le llama *rango*.\n- Hay veces que $\\gamma(h)\\to\\gamma_0>0$ cuando $h\\to 0$. A este valor $\\gamma_0$ se le llama *efecto nugget* (por las pepitas de oro encontradas en ríos, o en inglés, los ''gold nuggets'').\n\nA continuación se presenta un estimador clásico del variograma, el cual fue propuesto por Mathéron en 1962.\n\n::: {#def-variogmuest}\n\n### Variograma muestral\n\nEl *variograma muestral* del proceso espacial $Z$ es\n\n$$2\\widehat{\\gamma}(h)=\\frac{1}{|N(h)|}\\sum_{N(h)}{(Z(s_i)-Z(s_j))}^2,$$\n\ndonde $N(h)=\\{(i,j)\\ :\\ s_i-s_j=h\\}$ y $|N(h)|$ es el número de elementos distintos en $N(h)$.\n\n:::\n\nUna de las principales desventajas de este estimador es su sensibilidad a valores grandes de $Z$. En [@Cressie1] se puede revisar una variedad de ejemplos del uso de variograma. Aquí se da seguimiento al ejemplo del río Meuse de la sección [@sec-datgeost], presentando el variograma de los datos del plomo.\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(sp)\nlibrary(sf)\nlibrary(gstat)\n\ndata(meuse)\nmeuse_sp <- meuse\ncoordinates(meuse_sp) <- ~x + y\n\nvg_lead <- variogram(log(lead) ~ 1, data = meuse_sp, cloud = FALSE)\n\nplot(vg_lead$dist, vg_lead$gamma, \n     xlab = \"Distancia (m)\", \n     ylab = \"Semivarianza\",\n     pch = 19, col = \"red\",\n     main = \"Variograma muestral de Plomo (log-escala)\",\n     cex.main = 1.2, cex.lab = 1.1)\n\ntext(vg_lead$dist, vg_lead$gamma, \n     labels = vg_lead$np, \n     pos = 3, cex = 0.8, col = \"blue\")\n```\n\nLos números sobre cada punto en el mapa representan el número de pares de observaciones de $|N(h)|$ usados para la semivarianza. La utilidad de estos números radica en que\n\n- Dan un criterio para medir la confiabilidad de cada punto: si un punto se basa en pocos pares, la estimación es menos confiable.\n- Ayudan a evaluar la dispersión de las distancias: muchos pares en una banda significa que esa distancia es común en el diseño del experimento.\n\n\n\n\n\n\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":true,"html-math-method":"mathjax","output-file":"02-Exploratorio.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","other-links-title":"Otros Enlaces","code-links-title":"Enlaces de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Cuaderno de Artículo","notebook-preview-download":"Descargar Cuaderno","notebook-preview-download-src":"Descargar código fuente","notebook-preview-back":"Volver al Artículo","manuscript-meca-bundle":"Archivo MECA","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licencia","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","title-block-keywords":"Palabras clave","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","tools-share":"Compartir","tools-download":"Descargar","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-wordcount":"Conteo de Palabras","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados","listing-page-words":"{0} palabras","listing-page-filter":"Filtro","draft":"Borrador"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.7.29","bibliography":["../references.bib"],"theme":{"light":"cosmo","dark":"darkly"},"appearance":"auto","number-depth":3,"code-summary":"Código"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}